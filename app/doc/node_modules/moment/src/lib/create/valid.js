"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isValid = isValid;
exports.createInvalid = createInvalid;

var _extend = _interopRequireDefault(require("../utils/extend"));

var _utc = require("./utc");

var _parsingFlags = _interopRequireDefault(require("../create/parsing-flags"));

var _some = _interopRequireDefault(require("../utils/some"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function isValid(m) {
  if (m._isValid == null) {
    var flags = (0, _parsingFlags["default"])(m);

    var parsedParts = _some["default"].call(flags.parsedDateParts, function (i) {
      return i != null;
    });

    var isNowValid = !isNaN(m._d.getTime()) && flags.overflow < 0 && !flags.empty && !flags.invalidMonth && !flags.invalidWeekday && !flags.weekdayMismatch && !flags.nullInput && !flags.invalidFormat && !flags.userInvalidated && (!flags.meridiem || flags.meridiem && parsedParts);

    if (m._strict) {
      isNowValid = isNowValid && flags.charsLeftOver === 0 && flags.unusedTokens.length === 0 && flags.bigHour === undefined;
    }

    if (Object.isFrozen == null || !Object.isFrozen(m)) {
      m._isValid = isNowValid;
    } else {
      return isNowValid;
    }
  }

  return m._isValid;
}

function createInvalid(flags) {
  var m = (0, _utc.createUTC)(NaN);

  if (flags != null) {
    (0, _extend["default"])((0, _parsingFlags["default"])(m), flags);
  } else {
    (0, _parsingFlags["default"])(m).userInvalidated = true;
  }

  return m;
}